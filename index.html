<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨çƒé§•ç…§äº’æƒ æŸ¥è©¢ v2.0</title>
    <style>
        :root {
            --intl-color: #d1e3e9; /* åœ‹éš›é§•ç…§è—ç¶ è‰² */
            --tw-color: #e9e2d1;   /* ä¸€èˆ¬é§•ç…§æ·ºè¤è‰² */
            --allowed: #27ae60;
            --conditional: #f39c12;
            --prohibited: #e74c3c;
            --sidebar-width: 280px;
        }

        body { font-family: "PingFang TC", sans-serif; margin: 0; background: #f0f2f5; display: flex; flex-direction: column; min-height: 100vh; }
        
        /* é ‚éƒ¨åœ–èªªèˆ‡æ¨™é¡Œ */
        header { background: #2c3e50; color: white; padding: 20px 40px; }
        .legend { display: flex; gap: 20px; font-size: 0.9rem; margin-top: 10px; }
        .legend-item { display: flex; align-items: center; gap: 8px; }
        .box { width: 16px; height: 16px; border-radius: 3px; }

        /* ç‰ˆé¢é…ç½®ï¼šå´é‚Šæ¬„ + ä¸»å…§å®¹ */
        .main-container { display: flex; flex: 1; }
        
        /* å·¦å´ç¯©é¸å™¨ */
        aside { 
            width: var(--sidebar-width); 
            background: white; 
            padding: 20px; 
            border-right: 1px solid #ddd;
            position: sticky;
            top: 0;
            height: calc(100vh - 40px);
            overflow-y: auto;
        }
        .filter-group { margin-bottom: 25px; }
        .filter-group h4 { margin-bottom: 10px; border-bottom: 2px solid #eee; padding-bottom: 5px; }
        .filter-option { display: block; margin: 8px 0; cursor: pointer; font-size: 0.95rem; }
        .filter-option input { margin-right: 10px; }

        /* ä¸»å…§å®¹å€ï¼šPinterest éŒ¯è½ä½ˆå±€ */
        content { flex: 1; padding: 20px; }
        .masonry-grid { 
            column-count: 3; 
            column-gap: 20px; 
            width: 100%;
        }
        @media (max-width: 1100px) { .masonry-grid { column-count: 2; } }
        @media (max-width: 700px) { .masonry-grid { column-count: 1; } aside { display: none; } }

        /* å¡ç‰‡è¨­è¨ˆ */
        .card { 
            break-inside: avoid; 
            margin-bottom: 20px; 
            background: white; 
            border-radius: 12px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.08); 
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        .card-header { padding: 15px; text-align: center; background: white; border-bottom: 1px solid #f0f0f0; }
        .flag { font-size: 1.5rem; margin-right: 8px; vertical-align: middle; }

        /* é›™è‰²å¡Šå€åˆ† */
        .section { padding: 15px; font-size: 0.9rem; }
        .section-intl { background: var(--intl-color); }
        .section-tw { background: var(--tw-color); }

        /* äº’æƒ ç‹€æ…‹æ¨™ç±¤ */
        .status-badge { 
            display: inline-block; 
            padding: 3px 10px; 
            border-radius: 15px; 
            color: white; 
            font-size: 0.8rem; 
            font-weight: bold; 
            margin-bottom: 8px; 
            cursor: pointer;
        }
        .status-allowed { background: var(--allowed); }
        .status-conditional { background: var(--conditional); }
        .status-prohibited { background: var(--prohibited); }

        footer { background: white; padding: 20px; text-align: center; font-size: 0.85rem; color: #666; border-top: 1px solid #ddd; }
    </style>
</head>
<body>

<header>
    <h1>å…¨çƒé§•ç…§äº’æƒ æŸ¥è©¢ v2.0</h1>
    <div class="legend">
        <div class="legend-item"><div class="box" style="background:var(--intl-color)"></div> åœ‹éš›é§•ç…§å€å¡Š</div>
        <div class="legend-item"><div class="box" style="background:var(--tw-color)"></div> å°ç£ä¸€èˆ¬é§•ç…§å€å¡Š</div>
    </div>
</header>

<div class="main-container">
    <aside id="filters">
        <div class="filter-group">
            <h4>ä¾å€åŸŸ (æ´²åˆ¥)</h4>
            <div id="region-filters"></div>
        </div>
        <div class="filter-group">
            <h4>ä¾äº’æƒ ç‹€æ…‹</h4>
            <label class="filter-option"><input type="checkbox" value="success" class="status-chk"> Allowed å¯ä»¥ä½¿ç”¨</label>
            <label class="filter-option"><input type="checkbox" value="warning" class="status-chk"> Conditional ä¾æ¢ä»¶ä½¿ç”¨</label>
            <label class="filter-option"><input type="checkbox" value="danger" class="status-chk"> Prohibited ä¸å¯ä½¿ç”¨</label>
        </div>
    </aside>

    <content>
        <div class="masonry-grid" id="card-grid">
            </div>
    </content>
</div>

<footer>
    è³‡æ–™ä¾†æºï¼šä¸­è¯æ°‘åœ‹äº¤é€šéƒ¨å…¬è·¯ç¸½å±€ | æœ€å¾Œæ›´æ–°æ—¥ï¼š2026-01-23 <br>
    æœ€æ–°è³‡è¨Šè«‹ç¢ºèª <a href="https://www.thb.gov.tw/" target="_blank">å…¬è·¯ç¸½å±€ç¶²ç«™</a>
</footer>

<script>
    const statusLabels = {
        success: "Allowed å¯ä»¥ä½¿ç”¨",
        warning: "Conditional ä¾æ¢ä»¶ä½¿ç”¨",
        danger: "Prohibited ä¸å¯ä½¿ç”¨"
    };

    let fullData = [];

    // å–å¾—åœ‹æ—— Emoji çš„è¼”åŠ©å‡½å¼ (åŸºæ–¼åœ‹å®¶åç¨±å°æ‡‰ï¼Œå»ºè­°æœªä¾†å¯æ›æˆ ISO Code)
    function getFlag(country) {
        const flagMap = { "å¾·åœ‹": "ğŸ‡©ğŸ‡ª", "æ—¥æœ¬": "ğŸ‡¯ğŸ‡µ", "ç´è¥¿è˜­": "ğŸ‡³ğŸ‡¿", "è¶Šå—": "ğŸ‡»ğŸ‡³", "å°å°¼": "ğŸ‡®ğŸ‡©", "åŠ æ‹¿å¤§": "ğŸ‡¨ğŸ‡¦", "æ³¢è˜­": "ğŸ‡µğŸ‡±", "æ¾³æ´²": "ğŸ‡¦ğŸ‡º" };
        return flagMap[country] || "ğŸ³ï¸";
    }

    async function init() {
        const res = await fetch(`data/data.json?t=${Date.now()}`);
        fullData = await res.json();
        setupFilters();
        render();
    }

    function setupFilters() {
        const regions = [...new Set(fullData.map(d => d.region))];
        const container = document.getElementById('region-filters');
        regions.forEach(r => {
            const label = document.createElement('label');
            label.className = 'filter-option';
            label.innerHTML = `<input type="checkbox" value="${r}" class="region-chk"> ${r}`;
            label.onchange = render;
            container.appendChild(label);
        });
        document.querySelectorAll('.status-chk').forEach(c => c.onchange = render);
    }

    function render() {
        const activeRegions = Array.from(document.querySelectorAll('.region-chk:checked')).map(c => c.value);
        const activeStatus = Array.from(document.querySelectorAll('.status-chk:checked')).map(c => c.value);

        const grid = document.getElementById('card-grid');
        grid.innerHTML = '';

        const filtered = fullData.filter(d => {
            const regionMatch = activeRegions.length === 0 || activeRegions.includes(d.region);
            const statusMatch = activeStatus.length === 0 || activeStatus.includes(d.international.status) || activeStatus.includes(d.general.status);
            return regionMatch && statusMatch;
        });

        filtered.forEach(item => {
            const card = document.createElement('div');
            card.className = 'card';
            const val = (v) => (v && v !== "ç„¡") ? v : "ç„¡";

            card.innerHTML = `
                <div class="card-header">
                    <span class="flag">${getFlag(item.country)}</span><strong>${item.country}</strong>
                </div>
                <div class="section section-intl">
                    <div class="status-badge status-${item.international.status}" onclick="filterByStatus('${item.international.status}')">
                        ${statusLabels[item.international.status]}
                    </div>
                    <div><strong>ç•¶åœ°ä½¿ç”¨ï¼š</strong>${val(item.international.usage)}</div>
                    <div><strong>å‚™è¨»ï¼š</strong>${val(item.international.notes)}</div>
                </div>
                <div class="section section-tw">
                    <div class="status-badge status-${item.general.status}" onclick="filterByStatus('${item.general.status}')">
                        ${statusLabels[item.general.status]}
                    </div>
                    <div><strong>ç•¶åœ°ä½¿ç”¨ï¼š</strong>${val(item.general.usage)}</div>
                    <div><strong>å‚™è¨»ï¼š</strong>${val(item.general.notes)}</div>
                </div>
            `;
            grid.appendChild(card);
        });
    }

    function filterByStatus(status) {
        document.querySelectorAll('.status-chk').forEach(c => {
            c.checked = (c.value === status);
        });
        render();
    }

    init();
</script>
</body>
</html>
